<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Follow the Flow: On Information Flow Across Textual Tokens in Text-to-Image Models</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- Bulma CSS for layout -->
  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro" rel="stylesheet">
  <!-- Meta tags for social media -->
  <meta name="description" content="Follow the Flow: A study of how information flows between textual tokens in text-to-image models. Learn how detokenization and token filtering reduce errors and semantic leakage.">
  <meta property="og:title" content="Follow the Flow – Token Flow in T2I Models"/>
  <meta property="og:description" content="Discover how focusing on the most representative tokens (illustrated by our zebra and pink colored giraffe demos) can improve image generation and reduce semantic leakage in T2I models."/>
  <meta property="og:url" content="https://yourdomain.com/follow-the-flow"/>
  <meta property="og:image" content="static/image/your_banner_image.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>
  <meta name="twitter:title" content="Follow the Flow – Token Flow in T2I Models">
  <meta name="twitter:description" content="Learn how detokenization and removing redundant tokens can enhance image generation in text-to-image models." >
  <meta name="twitter:image" content="static/images/your_twitter_banner_image.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="keywords" content="text-to-image, token flow, detokenization, semantic leakage, diffusion models">

  <!-- Custom CSS inspired by rome.baulab.info -->
  <style>
    body {
      font-family: 'Noto Sans', sans-serif;
      line-height: 1.6;
    }
    /* Fullheight hero with background image (replace with your header image) */
    .hero.is-fullheight {
      background: url('static/images/header.jpg') center center/cover no-repeat;
      position: relative;
      color: white;
    }
    .overlay {
      position: absolute;
      top:0;
      left:0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
    }
    .hero-body {
      position: relative;
      z-index: 2;
    }
    /* Navigation styling */
    nav.navbar {
      background: rgba(0,0,0,0.7);
    }
    nav.navbar a.navbar-item {
      color: white;
    }
    /* Section spacing */
    section {
      padding: 3rem 1.5rem;
    }
    .section-title {
      margin-bottom: 2rem;
      text-align: center;
    }
    /* Visual demo images */
    .visual-demo img {
      max-width: 100%;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.2);
    }
    /* Button styling */
    .button.is-primary {
      background-color: #3273dc;
      border-color: transparent;
    }
    /* Footer styling */
    footer {
      background: #222;
      color: #aaa;
      padding: 2rem 1.5rem;
      text-align: center;
    }
  </style>
</head>
<body>

  <!-- Navigation Bar -->
  <nav class="navbar is-fixed-top" role="navigation" aria-label="main navigation">
    <div class="navbar-brand">
      <a class="navbar-item" href="#home">
        Follow the Flow
      </a>
      <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navMenu">
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
        <span aria-hidden="true"></span>
      </a>
    </div>
    <div id="navMenu" class="navbar-menu">
      <div class="navbar-end">
        <a class="navbar-item" href="#abstract">Abstract</a>
        <a class="navbar-item" href="#visual">Visual Demos</a>
        <a class="navbar-item" href="#methodology">How It Works</a>
        <a class="navbar-item" href="#results">Results</a>
        <a class="navbar-item" href="#download">Download</a>
      </div>
    </div>
  </nav>

  <!-- Hero Section -->
  <section class="hero is-fullheight" id="home">
    <div class="overlay"></div>
    <div class="hero-body">
      <div class="container has-text-centered">
        <h1 class="title is-1">Follow the Flow</h1>
        <h2 class="subtitle is-3">On Information Flow Across Textual Tokens in Text-to-Image Models</h2>
        <p class="is-size-5">Understanding how detokenization and token filtering improve image generation by reducing semantic leakage and redundancy.</p>
      </div>
    </div>
  </section>

  <!-- Abstract Section -->
  <section id="abstract">
    <div class="container">
      <h2 class="title section-title">Abstract</h2>
      <div class="content">
        <p>
          Text-to-Image (T2I) models often suffer from semantic leakage, incorrect feature binding, and omission of key concepts. Our work challenges the common assumption that all tokens equally represent their lexical items. We show that most of the meaningful information within a word is captured by just one or two tokens, while the remaining tokens are redundant. By removing these non-representative tokens, image generation errors are reduced by 21%. Furthermore, by patching leaked token representations with their uncontextualized counterparts, we mitigate semantic leakage by 85%.
        </p>
      </div>
    </div>
  </section>

  <!-- Visual Demonstrations Section -->
  <section id="visual" class="has-background-light">
    <div class="container">
      <h2 class="title section-title">Visual Demonstrations</h2>
      <div class="columns is-vcentered">
        <!-- Zebra GIF: Cleaning/Detokenization -->
        <div class="column visual-demo">
          <figure class="image">
            <img src="static/images/zebra.gif" alt="Zebra demonstrating detokenization: only 1 or 2 tokens are representative">
          </figure>
          <p class="has-text-centered">Zebra: Illustrating the cleaning technique where only 1–2 tokens are representative.</p>
        </div>
        <!-- Pink Colored Giraffe GIF: Avoiding Redundant Tokens -->
        <div class="column visual-demo">
          <figure class="image">
            <img src="static/images/a_pink_colored_giraffe.gif" alt="Pink colored giraffe demonstrating improved generation by avoiding redundant tokens">
          </figure>
          <p class="has-text-centered">Pink Colored Giraffe: Demonstrating improved image generation by not decoding redundant tokens.</p>
        </div>
      </div>
    </div>
  </section>

  <!-- How It Works Section -->
  <section id="methodology">
    <div class="container">
      <h2 class="title section-title">How It Works</h2>
      <div class="content">
        <p>
          Our method involves two complementary analyses:
        </p>
        <ul>
          <li>
            <strong>In-item Information Flow:</strong> We use a causal intervention on the text encoder to isolate each token’s contribution within a lexical item. Our experiments reveal that most meaningful information is concentrated in one or two tokens, while the others are redundant.
          </li>
          <li>
            <strong>Inter-item Information Flow:</strong> We analyze how tokens from different lexical items interact. In cases of semantic leakage—where one token’s representation is influenced by another—we mitigate the effect by replacing the leaked representation with its uncontextualized version.
          </li>
        </ul>
        <p>
          This approach improves the alignment between textual prompts and generated images, reducing errors and enhancing overall generation quality.
        </p>
      </div>
    </div>
  </section>

  <!-- Results Section -->
  <section id="results" class="has-background-light">
    <div class="container">
      <h2 class="title section-title">Results</h2>
      <div class="content">
        <ul>
          <li>Removing non-representative tokens reduces image generation errors by <strong>21%</strong>.</li>
          <li>Patching leaked token representations mitigates semantic leakage by <strong>85%</strong>.</li>
          <li>Analysis shows that a lexical item is typically fully represented by just one or two tokens.</li>
          <li>Our evaluation using vision-language models confirms the robustness of our intervention.</li>
        </ul>
      </div>
    </div>
  </section>

  <!-- Download and Links Section -->
  <section id="download">
    <div class="container">
      <h2 class="title section-title">Get the Paper</h2>
      <div class="buttons is-centered">
        <a href="static/pdfs/follow_the_flow.pdf" target="_blank" class="button is-primary">
          <span class="icon"><i class="fas fa-file-pdf"></i></span>
          <span>Download Paper</span>
        </a>
        <a href="static/pdfs/follow_the_flow_supplementary.pdf" target="_blank" class="button is-link">
          <span class="icon"><i class="fas fa-file-pdf"></i></span>
          <span>Supplementary Material</span>
        </a>
        <a href="https://github.com/tokeron/lens" target="_blank" class="button is-info">
          <span class="icon"><i class="fab fa-github"></i></span>
          <span>View Code</span>
        </a>
        <a href="https://arxiv.org/abs/2410.05864" target="_blank" class="button is-danger">
          <span class="icon"><i class="ai ai-arxiv"></i></span>
          <span>arXiv</span>
        </a>
      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer>
    <p>
      &copy; 2025 Follow the Flow. Developed by Guy Kaplan, Michael Toker, Yuval Reif, Yonatan Belinkov, and Roy Schwartz.
    </p>
    <p>
      This work is licensed under the <a href="http://creativecommons.org/licenses/by-sa/4.0/" target="_blank" style="color: #ccc;">Creative Commons Attribution-ShareAlike 4.0 International License</a>.
    </p>
  </footer>

  <!-- JavaScript for Navbar Burger (for mobile responsiveness) -->
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const navbarBurgers = Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'), 0);
      if (navbarBurgers.length > 0) {
        navbarBurgers.forEach(el => {
          el.addEventListener('click', () => {
            const target = el.dataset.target;
            const $target = document.getElementById(target);
            el.classList.toggle('is-active');
            $target.classList.toggle('is-active');
          });
        });
      }
    });
  </script>
</body>
</html>
